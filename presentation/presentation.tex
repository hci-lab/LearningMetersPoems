\documentclass[10pt]{beamer}

\usetheme[progressbar=frametitle]{metropolis}
\usepackage{appendixnumberbeamer}
\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}
\usepackage{mathtools}
\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\usepackage{xspace}
\usepackage{amsmath}
\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\usefonttheme{professionalfonts} % using non standard fonts for beamer
\usefonttheme{serif} % default family is serif

\usepackage{tipa}
\usepackage{xcolor}

\definecolor{myBlue}{HTML}{7982db}
\definecolor{myGreen}{HTML}{ABDDA4}
\definecolor{myBlue2}{HTML}{4169AA}
\definecolor{myGreen2}{HTML}{38AE40}

\usetikzlibrary{arrows} % For arrows :"D



% For Arabic
\usepackage{polyglossia} 
\setmainlanguage{english}
\setotherlanguage{arabic}
% Defining the font family
\newfontfamily\arabicfont  [Script=Arabic, Scale=1.5]{Scheherazade}%
\newfontfamily\arabicfontsf[Script=Arabic, Scale=1.5]{Scheherazade}%

\usepackage{bidipoem}

\title{Learning Meters of Arabic and English poems}
\subtitle{With Recurrent Neural Networks}
\date{\today}
\author{
Prof. Waleed A. YOUSEF \\
The Team}
\institute{Computer Science department\\
Faulty of Computers and Information, Helwan University}

%\title{A Practical Introduction to Natural Language Processing}
%
%\subtitle{Intelligent Processing \& Applications\\Research Cluster Seminar}
%
%%\date{5 \& 12 March 2015}
%%\date{5 March 2015\\Session 1: Common Tasks and Concepts in NLP}
%%\date{12 March 2015\\Session 2: Software Libraries and Resources for NLP}
%\date{5 March 2015\\Session 1: Common Tasks and Concepts in NLP\\[0.5ex]
%12 March 2015\\Session 2: Software Libraries and Resources for NLP}
%\author{Dr Lim Lian Tze}
%\institute{
%Information Technology Department\\
%School of Science, Engineering and Technology\\
%KDU College Penang
%}

\begin{document}
\setbeamertemplate{caption}{\raggedright\insertcaption\par}


\maketitle

\begin{frame}{Table of contents}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}



% 1
\section{Introduction}
\begin{frame}[fragile]{Hello, Arabic}
    \begin{center}
    \begin{Arabic}
    ودعْ عنك آراءَ الرجالِ وقولَهم\hspace{3em}  فقولُ رسولِ الله أزكى وأشرحُ
    \end{Arabic}
    \end{center}
\end{frame}


% But ... What is poetry?
\begin{frame}[fragile]{But ... What is poetry?}

\textbf{\large General Definition}:
\begin{itemize}
  \item \textbf{Poetry} is a piece of writing or speaking, which
\textbf{\textcolor{red}{MUST}} follow specific
\alert{\underline{\textbf{Patterns}}}.
\end{itemize}

\vspace{0.5cm}
\textbf{\large Example}, \textit{\small English verse}:
\begin{center}
That 
  \textcolor{myGreen2}{\textbf{time}} of 
  \textcolor{myGreen2}{\textbf{year}} thou
  \textcolor{myGreen2}{\textbf{mayst}}  in 
  \textcolor{myGreen2}{\textbf{me}}
be\textcolor{myGreen2}{\textbf{hold}}
\end{center}

To detect poems' meters, we need to learn those \alert{\textbf{Patterns}}.
\end{frame}




\begin{frame}[fragile]{Arabic Prosody \textarabic{العَرُوض}}
    \begin{Arabic}
    ودعْ عنك آراءَ الرجالِ وقولَهم\hspace{1em}  فقولُ رسولِ الله أزكى وأشرحُ
    \end{Arabic}

% Half 1
\begin{columns}
\begin{column}{0.7\textwidth}

% ◌
\begin{itemize}
  \item A \textbf{poem } is a collection of verses.
  \item \textbf{Vowels}  carry one of \textarabic{◌َ  ◌ُ  ◌ِ}.
  \item \textbf{Consonants} carry \textarabic{◌ْ}.
  \item A \textbf{foot} \textarabic{التفعيلة}: is an \textbf{ordered} sequence of vowels and consonants.
\end{itemize}

\end{column}


% half 2
\begin{column}{0.5\textwidth}
\begin{center}
  \begin{tabular}{|c|c|} \hline
    \textbf{Feet} & \textbf{Scansion} \\
    \hline
    \textarabic{فَعُولُنْ}  & \texttt{0/0//}\\
    \textarabic{فَاعِلُنْ}  & \texttt{0//0/}\\
    \textarabic{مُسْتَفْعِلُنْ}& \texttt{0//0/0/}\\
    \textarabic{مَفاعِيلُنْ}& \texttt{0/0/0//}\\
    \textarabic{مَفْعُولاَت} & \texttt{0//0///}\\
    \textarabic{فَاعِلاَتُنْ} & \texttt{0/0//0/}\\
    \textarabic{مُفَاعَلَتُنْ}& \texttt{0///0//}\\
    \textarabic{مُتَفَاعِلُنْ}& \texttt{0//0///}\\
    \hline
  \end{tabular}
\end{center}
\end{column}
\end{columns}
\end{frame}





\begin{frame}[fragile]{Arabic Prosody \textarabic{العَرُوض}}

\begin{itemize}
  \item \textbf{Meter} \textarabic{البحر}: is an \textbf{ordered} sequence of \alert{feet}. 
\end{itemize}



\begin{center}
  \textarabic{ويسْأل فىْ الْحواْدث ذوْ صواْبٍ}\\
  \textarabic{ويسأل فل \hspace{0.4cm}
    حوادث ذو\hspace{0.4cm}
    صوابن}\\
  \texttt{0/0//     \hspace{0.3cm}
          0///0//   \hspace{0.3cm}
          0///0//}\\

  \textarabic{مفاْعلتنْ\hspace{0.7cm} 
    مفاْعلتنْ          \hspace{0.7cm}
    فعوْلنْ}
\end{center}


\begin{center}
  \begin{tabular}[h!]{|c|c|} 
    \hline
    \textbf{Meter Name} & \textbf{Meter} \small{\textit{feet combination}} \\ 
    \hline
   \textit{al-Wafeer}    & \textarabic{مُفَاعَلَتُن مُفَاعَلَتُن فَعُولُن} \\ %
   \textit{al-Taweel}    & \textarabic{فَعُوْلُنْ مَفَاْعِيْلُنْ فَعُوْلُنْ مَفَاْعِلُنْ} \\ %
   \vdots                &  \vdots\\
   \textit{al-Moktadib}  & \textarabic{مَفْعُوْلاتُ مُسْتَفْعِلُنْ مُسْتَفْعِلُن} \\
   \textit{al-Modar'e}   & \textarabic{مَفَاْعِيْلُنْ فَاْعِلاتُنْ مَفَاْعِيْلُنْ} \\
    \hline
  \end{tabular}
\end{center}
%%%%
\end{frame}








\begin{frame}[fragile]{English Prosody}


\textbf{English Meters Building Blocks}:
\begin{itemize}
  \item \textbf{Syllables}: \textipa{\sffamily /"wO:t@/} = \textipa{\sffamily /"wO:/}  $+$ \textipa{\sffamily /t@(r)/}.
    \begin{itemize}
         \item \textcolor{myGreen2}{\textbf{stressed}} $+$ unstressed.
    \end{itemize}
  \item \textbf{Foot}: is a combination of stressed and unstressed syllables. 

\end{itemize}

\begin{center}
\begin{tabular}{|c | c|} 
    \hline
    %\toprule
    Feet     & Stresses Combination\\ 
    \hline
    %\toprule
    \textit{Iamb} & $\times$\textit{/}\\             %\midrule
    \textit{Trochee}& \textit{/}$\times$\\           %\midrule
    \textit{Dactyl} & \textit{/}$\times\times$\\     %\midrule
    \textit{Anapest}& $\times\times$\textit{/}\\     %\midrule
    \textit{Pyrrhic}& $\times\times$\\               %\midrule
    \textit{Amphibrach}& $\times$\textit{/}$\times$\\%\midrule
    \textit{Spondee}& \textit{/}\textit{/}\\
    %\bottomrule
    \hline
\end{tabular}
\end{center}

\textbf{Meter}: is repeating a foot $n$ times; where $n \in [1, 8]$. 
\end{frame}





\begin{frame}[fragile]{English Patterns}

\textit{Iambic pentameter} verse:
\begin{center}
$\underbrace{\text{That \textcolor{myGreen2}{\textbf{time}}}
}_\text{Iambic Foot}$\hspace{0.2cm}
%
$\overbrace{\text{of \textcolor{myGreen2}{\textbf{year}}}
}^\text{2nd}$\hspace{0.2cm}
%
$\overbrace{\text{thou \textcolor{myGreen2}{\textbf{mayst}}}
}^\text{3rd}$\hspace{0.2cm}
%
$\overbrace{\text{in \textcolor{myGreen2}{\textbf{me}}}
}^\text{4th}$\hspace{0.2cm}
%
$\overbrace{\text{be\textcolor{myGreen2}{\textbf{hold}}.}
}^\text{5th}$\hspace{0.2cm}
\end{center}
\end{frame}






% Literature 
\section{Literature Review}
\begin{frame}[fragile]{Detecting Arabic poems' Meters}

\textbf{Abuata and Al-Omari}:
    \begin{itemize}
        \item Five-step Algorithm
            \begin{enumerate}
                \item Getting the input, carrying full diacritics.
                \item Metrical scansion rules are applied to the Arud writing. 0/0/..
                \item Grouping zero and ones to feet \textarabic{تفعيلات}.
                \item A class is assigned  to the input.
            \end{enumerate}
        \item \textbf{\alert{Results}}: 82.2\% of 417 verses.
    \end{itemize}
\textbf{Alnagdawi et al}, similar approach;  Context-Free Grammar; 75\% correctly
classed from 128.
\end{frame}

\begin{frame}[fragile]{example!}

\begin{itemize}
    \item Probabilistic operation 
\end{itemize}

\begin{center}
  \textarabic{ويسْأل فىْ الْحواْدث ذوْ صواْبٍ}\\
  \textarabic{ويسأل فل \hspace{0.4cm}
    حوادث ذو\hspace{0.4cm}
    صوابن}\\
  \texttt{0/0//     \hspace{0.3cm}
          0///0//   \hspace{0.3cm}
          0///0//}\\

  \textarabic{مفاْعلتنْ\hspace{0.7cm} 
    مفاْعلتنْ          \hspace{0.7cm}
    فعوْلنْ}
\end{center}

\end{frame}

\begin{frame}[fragile]{Abuata and Al-Omari \& Alnagdawi et al; Problems}
Issues;
    \begin{itemize}
       \item A huge constrain. \alert{Diacritics} are a must.
        % A source of randomness.
       \item Converting the text into pronounced text is \alert{probabilistic}.
            \begin{itemize}
                % الرحمن لكن هذا إله السموات
                \item \textarabic{اثبات الحروف المحذوفة خطاً}
                \item \textarabic{التصرف فى التقاء الساكنين}
            \end{itemize}
    \end{itemize}
\end{frame}




\begin{frame}[fragile]{Tanasescu et al. \&  Tizhoosh and Dara \& Almuhareb et al.}
\textbf{Metric} or \textbf{Free-Verse}: 
        \begin{itemize}
            \item Verses are represented as vectors of \alert{statistical features}.
            \begin{itemize}
                \item[--] Average number of feet per line.
                \item[--] Longest run of a single foot.
                \item[--] Percentage of foot changes.
            \end{itemize}
            \item He has used an stress-annotated dataset, which means that the pattern is already detected!
            \item A couples of tries for detecting poem inside documents depending on visual features, for both Arabic and English.
            \begin{itemize}
                \item[--] Averge of line legth.
                \item[--] Averge number of block.
                \item[--] etc ...
            \end{itemize}
        \end{itemize}
\end{frame}




\begin{frame}[fragile]{Our point of departure}
% Insulting
\begin{itemize}
    \item Detecting poems inside documents by its visual feature represent the majority of the research related to poetry.
    \item For detecting meters, all models are so naive and primitive. They do no have any clue about the real pattern.
\end{itemize}

\end{frame}




\section{Datasets}
\begin{frame}[fragile]{Datasets}
\textbf{Arabic Dataset}:
\begin{itemize}
    \item Our dataset consists of  1,722,321 data points labeled by\\ the 16 meters.
    \item Verses are for 3701 poets from 11 ages.
\end{itemize}
\begin{center}
\input{MeterSizesBarChart}
\end{center}
\end{frame}

\begin{frame}[fragile]{Datasets}
\textbf{English Dataset}:
\begin{itemize}
    \item Our dataset consists of 17,744 verses only, labeled by 4 meters.
    \item This is what we have found after an extensive search.
\end{itemize}
\begin{center}
\input{englishMeterSizes.tex}
\end{center}
\end{frame}



\begin{frame}[fragile]{Motivation}
\begin{itemize}
    \item The effect of the diacritics over the learning curve.
    \item The effect of the dataset size over the learning curve.
    \item Best technique to represent character-level text. 
\end{itemize}

\end{frame}


\section{Methodology}
\begin{frame}[fragile]{Which Network!}


\begin{columns}


\begin{column}{0.7\textwidth}
\begin{itemize}
    \item[--] \textbf{Pattern}: is a sequence of characters.
    \item  Unlike feedforward neural networks, RNNs can use their internal state (memory) to process sequences of inputs.
\end{itemize}

\end{column}



\begin{column}{0.5\textwidth}  %%<--- here
    \begin{figure}
        \begin{center}
         \includegraphics[width=0.5\textwidth]{rolledRNN.png}
         \caption{Rolled Rnn unit}
         \end{center}
    \end{figure}
\end{column}
\end{columns}
\end{frame}



\begin{frame}[fragile]{RNN, Architectures}

\begin{center}
    \input{fig1}
\end{center}
\begin{itemize}
    \item Two variants of \textit{recurrent units}.
    \item LSTM and GRU are designed for the same reason, to avoid vanishing problem and long term dependency problem .
\end{itemize}
\end{frame}

\begin{frame}[fragile]{RNN, Architectures}
\begin{figure}
\centering
\includegraphics[scale=0.3]{uni_rnn}
\caption{Unidirectional RNN}
\end{figure}

\begin{figure}
\centering
\includegraphics[scale=0.3]{bi}
\caption{Bidirectional RNN}
\end{figure}
\end{frame}

\begin{frame}[fragile]{Data Representation}
An Issue:
\begin{itemize}
    \item Diacritics are standalone characters!
    \begin{itemize}
        \item \texttt{len} \textarabic{مرحبا} $\neq$ \texttt{len} \textarabic{مَرْحَبَاً}
        \item We have represented the letter and its diacritic as a \alert{one character}.
    \end{itemize}
\end{itemize}
\textbf{Benefits}:
\begin{enumerate}
    \item Verse's length is fixed, regardless the diacritic states.
    \item Saving more space, by shorten the length of full diacritic verses. 
    \item Models can be tested on both diacritic or non-diacritic data.
\end{enumerate}
\end{frame}

\begin{frame}[fragile]{Encoding Techniques}
\begin{enumerate}
    \item One-Hot
    \item Binary
    \item \alert{Two-Hot} (new technique)

\end{enumerate}
\end{frame}

\begin{frame}[fragile]{One-Hot}
    \begin{center}
        %\input{oldOneHot}
        \includegraphics[scale=0.3]{fig2.png}
    \end{center}
181 is the number of all combination between letters and diacritics.\\
$181 = 36 + 36 \times 4 + 1$
\end{frame}

\begin{frame}[fragile]{One-Hot, example}
    \begin{center}
        \input{subfigureOneHot}
    \end{center}
For English, vector length is 28. 
\end{frame}

\begin{frame}[fragile]{Binary}
Let $n$ be the vector length.\\
$n = \ceil*{\log_2 l}$ $l \in \{181, 28\}$ for Arabic and English alphabet, respectively.   
    \begin{center}
        \input{subfigureBinary}
    \end{center}
\end{frame}



\begin{frame}[fragile]{Pros and Cons}


\begin{columns}
%Right side
\begin{column}{0.7\textwidth}
\textbf{One-Hot}:
\begin{itemize}
    \item $181 \times 1$ too long vector.
    \item Wast of memory, compared towith Binary.
\end{itemize}
But it's very informative and easy to learn.\\[0.7cm]

\textbf{Binary}:
\begin{itemize}
    \item The problem of a common feature, the optimizer updates weights of this two common features to reduce the error of one character of them it will affect the rest characters that have the same feature.
\end{itemize}
But, memory is well consumed.
\end{column}
% Left side
\begin{column}{0.35\textwidth}
\begin{tikzpicture}[scale=0.5]
\begin{axis}[
    symbolic x coords={
    % the x ordering.
    One-Hot,
    Binary,
    },
    xtick=data,
    % the following x label positioning does work here.
    every axis y label/.style= {at={( 0.1, 1.1)}, anchor=north},
    ylabel={Bytes},
    x=3.5cm,
    ytick={7216, 161728},
    % X ticks configurations
    x tick label style={anchor=north},
    /pgf/bar width=10pt,
    % Y ticks configurations
    y tick label style={/pgf/number format/.cd,%
      scaled y ticks = false,
      set thousands separator={,},
      fixed},] 

    \addplot[ybar,fill=myBlue] coordinates {
        % Ordering does not effect.
        (One-Hot, 161728)
        (Binary,  7216)
    };
\end{axis}
\end{tikzpicture}
\begin{center}
\input{commonFeatures}
\end{center}
\end{column}
\end{columns}

\end{frame}





\begin{frame}[fragile]{Two-Hot Encoding}

\begin{columns}
%Right side
\begin{column}{0.77\textwidth}
\input{lolo.tex}
\end{column}
% Left side
\begin{column}{0.5\textwidth}

%%%%%%
\begin{tikzpicture}[scale=0.45]
\begin{axis}[
    symbolic x coords={
    % the x ordering.
    One-Hot,
    Two-Hot,
    Binary,
    },
    xtick=data,
    % the following x label positioning does work here.
    every axis y label/.style= {at={( 0.1, 1.1)}, anchor=north},
    ylabel={Bytes},
    x=3cm,
    ytick={7216, 35632, 161728},
    % X ticks configurations
    x tick label style={anchor=north},
    /pgf/bar width=20pt,
    % Y ticks configurations
    y tick label style={/pgf/number format/.cd,%
      scaled y ticks = false,
      set thousands separator={,},
      fixed},] 

    \addplot[ybar,fill=myBlue] coordinates {
        % Ordering does not effect.
        (One-Hot, 161728)
        (Two-Hot, 35632)
        (Binary,  7216)
    };
\end{axis}
\end{tikzpicture}



\end{column}
\end{columns}

\begin{itemize}
    \item Memory is well consumed.
    \item Have only one common feature.
    \item For Arabic only.
\end{itemize}

\end{frame}





\section{Results}  

\begin{frame}[fragile]{Arabi Results}
\begin{center}
 \begin{tabular}{c c c c c c c}
     %\hline
     \toprule
     \small{\#                    }& 
     \small{data size    }& 
     \small{encoding     }&
     \small{diacritic    }&
     \small{archit.      }&
     \small{f1           }     \\
     %\hline
     \midrule
    % NOTE: make the expressions full data, eliminated, .. so clear and link them
    % to the model section.

% NOTE:  +1 add to the layer number
% NOTE:  see a way to add the architecture details for each model.

   % NOTE: f1 = 91.4% if test on no diacritic test data.
   % relearn_drop_2_Exp_6_full_data_matrix_with_tashkeel_two_hot_encoding_Bidirectional_LSTM_6_50_0
   \small{1} & \small{full data} & \small{two-hot} & \small{Yes} & \small{7L, 50U, 0} &\small{95.79\%}\\ 
   % relearn_drop_2_Exp_5_full_data_matrix_without_tashkeel_two_hot_encoding_Bidirectional_LSTM_6_50_0
   \small{2} & \small{full data} & \small{two-hot} & \small{No} & \small{7L, 50U, 0} & \small{95.43\%}\\ 
   % relearn_drop_2_Exp_7_full_data_matrix_with_tashkeel_8bitsEncoding_Bidirectional_LSTM_6_81_0
   \small{3} & \small{full data} & \small{binary} & \small{Yes} & \small{7L, 81U, 0} & \small{95.51\%}\\ 
   % relearn_drop_2_Exp_7_full_data_matrix_without_tashkeel_8bitsEncoding_Bidirectional_LSTM_9_30_0
   \small{4} & \small{full data} & \small{binary} & \small{No} & \small{10L, 30U, 0} & \small{93.2\%}\\ 
   % relearn_drop_2_Exp_6_full_data_matrix_with_tashkeel_one_hot_encoding_Bidirectional_LSTM_6_50_1
   \small{5} & \small{full data} & \small{one-hot} & \small{Yes} & \small{7L, 50U, 1} & \small{95.32\%}\\ 
   % relearn_drop_2_Exp_1_full_data_matrix_without_tashkeel_one_hot_encoding_Bidirectional_LSTM_3_50_0
   \small{6} & \small{full data} & \small{one-hot} & \small{No}  &\small{7L, 82U, 0} & \small{93.94\%}\\ 
   % relearn_drop_2_Exp_6_eliminated_data_matrix_with_tashkeel_two_hot_encoding_Bidirectional_LSTM_6_50_0
   \small{7} & \small{eliminated} & \small{two-hot} & \small{Yes} & \small{7L, 81U, 1} & \small{95.88\%}\\
   % Exp_2_eliminated_data_matrix_without_tashkeel_two_hot_encoding_Bidirectional_LSTM_3_50_1
   \small{8} & \small{eliminated} & \small{two-hot} & \small{No}  &\small{4L, 50U, 1} & \small{96.29\%}\\ 
   % relearn_drop_2_Exp_8_eliminated_data_matrix_with_tashkeel_8bitsEncoding_Bidirectional_LSTM_6_81_1/
   \small{9} & \small{eliminated} & \small{binary} & \small{Yes} & \small{7L, 81U, 1} & \small{94.87\%}\\ 
   % Exp_3_eliminated_data_matrix_without_tashkeel_8bitsEncoding_Bidirectional_LSTM_3_82_0
   \small{10} & \small{eliminated} & \small{binary} & \small{No} & \small{4L, 82U, 0} & \small{96.38\%}\\ 
   % relearn_drop_2_Exp_7_eliminated_data_matrix_with_tashkeel_one_hot_encoding_Bidirectional_LSTM_6_75_0
   \small{11} & \small{eliminated} & \small{one-hot} & \small{Yes} & \small{7L, 75U, 0} & \small{95.65\%}\\ 
   % relearn_drop_2_Exp_5_eliminated_data_matrix_without_tashkeel_one_hot_encoding_Bidirectional_LSTM_6_50_0
   \small{12} & \small{eliminated} & \small{one-hot} & \small{No} & \small{7L, 50U, 0} & \small{95.04\%}\\ 


     %\hline
     \bottomrule
 \end{tabular}
\end{center}

\end{frame}

\begin{frame}[fragile]{English Results}
\begin{center}
 \begin{tabular}{c c c c} 
     %\hline
     \toprule
     \textbf{id} & \textbf{encoding } & \textbf{cell type} & \textbf{f1 test}\\
     %\hline
     \midrule
     1 & one-hot & GRU  & 81.35\%\\ % exp69
%     2 & one-hot & GRU  & 79.49\%\\ % exp45
     2 & one-hot & LSTM & 80.34\%\\ % exp88
%     4 & binary  & GRU  & 73.52\%\\ % exp89
     3 & binary  & LSTM & 75.43\%\\ % exp46
     4 & binary  & GRU  & 75.04\%\\ % exp90

     %\hline
     \bottomrule
 \end{tabular}
\end{center}

\end{frame}




\begin{frame}[fragile]{Encoding Effect}
    \begin{center}
        \input{threeEncodingEffectOnLearning.tex}
    \end{center}
\end{frame}




\begin{frame}[fragile]{Binary Encoding Problem}
    \begin{center}
    \input{commonFeatures.tex}
    \end{center}
\end{frame}






{\setbeamercolor{palette primary}{fg=black, bg=yellow}
\begin{frame}[standout]
  Questions?
\end{frame}
}









\end{document}
